angular.module('killingCtrl', ['killingService', 'd3DateService', 'datetime', 'ngLodash'])
.controller('killingsController', function(Killing, $scope, lodash, d3date) {
  var vm = this;

  vm.processing = true;

  // using d3Date service we can get the dates, we can set the dates and format dates in DD-MM-YYYY or MM-DD-YYYY formats
  vm.d3DataByMonth = d3Date.getAllDates();
  vm.d3OnClick = function(item) {
    console.log('clicked item ', item);
    $scope.$apply(function() {
      if (!$scope.showDetailPanel) {
        $scope.showDetailPanel = true;
        $scope.detailItem = item;
      }
    });
  }

  Killing.all()
    .success(function(data) {
      vm.processing = false;
      vm.killings = data;
    });

  vm.deleteUser = function(id) {
    vm.processing = true;
    Killing.delete(id)
      .success(function(data) {
        if (data.success) {
          Killing.all()
            .success(function(data) {
              vm.processing = false;
              vm.killings = data;
            });
        }
      });
  };

  function init () {
    Killing.all()
        .success(function(data) {
            lodash.map(data, function(data) {
                var month = data.$reported_month;
                lodash.map(vm.d3DataByMonth, function(item) {
                    if (item.month == month) { item.killings++; }
                });
            });
        });
  }

  init();
})

.controller('killingCreateController', function(Killing) {
  var vm = this;

  vm.type = 'create';
  vm.processing = true;

  // vm.test = [{"reported_date":"July 31, 2015","geo_state":"NM","gender":"M","race":null,"name":"Jeremy Hatch","age":"34","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1087238037970999","news_link":"http://krqe.com/2015/07/31/officer-involved-shooting-occurs-in-roswell-friday-night/"},{"reported_date":"July 31, 2015","geo_state":"NM","gender":"M","race":"L","name":"Rafael Molina Jr.","age":"33","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086925301335606","news_link":"http://www.koat.com/news/police-ask-residents-to-avoid-garfield-at-edith/34474822"},{"reported_date":"July 31, 2015","geo_state":"TX","gender":"M","race":"L","name":"Philip ‘Flip’ Vallejo","age":"30","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086680694693400","news_link":"http://www.star-telegram.com/news/local/community/fort-worth/article29627467.html"},{"reported_date":"July 31, 2015","geo_state":"NV","gender":"M","race":"W","name":"Mark Perkins","age":"48","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086677994693670","news_link":"http://www.kolotv.com/home/headlines/Douglas-County-Sheriff-Deputies-Involved-in-Fatal-Shooting-320242491.html"},{"reported_date":"July 30, 2015","geo_state":"CA","gender":"M","race":"W","name":"Ryan Daniel Vrenon","age":"25","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086369474724522","news_link":"http://www.krcrtv.com/southbound-i5-closed-after-fatal-chp-shooting-near-dunsmuir/34443668"},{"reported_date":"July 30, 2015","geo_state":"CA","gender":"M","race":"B","name":"Filimoni Raiyawa","age":"57","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1086219891406147","news_link":"http://www.sfgate.com/crime/article/Dead-body-probe-on-Lombard-Street-in-S-F-6414831.php#photo-8384427"},{"reported_date":"July 30, 2015","geo_state":"MA","gender":"M","race":"L","name":"Wilmer Delgado Sobá","age":"38","source_of_death":"T,R","kbp_link":"facebook.com/KilledByPolice/posts/1086178218076981","news_link":"https://www.bostonglobe.com/metro/2015/07/30/man-critical-condition-after-rampage-worcester-market/JkrgMwQj3EgJeEdSpDuUMJ/story.html"},{"reported_date":"July 30, 2015","geo_state":"UT","gender":"M","race":"W","name":"Roger Darrin Barker","age":"53","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086080181420118","news_link":"http://www.sltrib.com/home/2784805-155/logan-swat-standoff-ends-with-deadly"},{"reported_date":"July 30, 2015","geo_state":"CA","gender":"M","race":"L","name":"Oscar Lotari Romero","age":"47","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1086077788087024","news_link":"http://losangeles.cbslocal.com/2015/07/30/deputies-shoot-stick-wielding-suspect-in-whittier/"},{"reported_date":"July 29, 2015","geo_state":"NM","gender":"M","race":null,"name":"Michael Malone","age":"34","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1085762101451926","news_link":"http://www.lcsun-news.com/las_cruces-news/ci_28555681/dona-ana-county-sheriffs-office-team-member-shoots"},{"reported_date":"July 28, 2015","geo_state":"AR","gender":"M","race":null,"name":"Timothy Johnson","age":"41","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1085564644805005","news_link":"http://www.kait8.com/story/29656479/one-dead-following-officer-involved-shooting-in-manila"},{"reported_date":"July 28, 2015","geo_state":"CO","gender":"M","race":"W","name":"Samuel Forgy","age":"22","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1085081734853296","news_link":"http://kwgn.com/2015/07/28/boulder-police-fatally-shoot-stabbing-suspect/"},{"reported_date":"July 28, 2015","geo_state":"TN","gender":"M","race":"W","name":"Allan F. White III","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1085076058187197","news_link":"http://www.wrcbtv.com/story/29646814/deputy-involved-shooting-in-bradley-county"},{"reported_date":"July 27, 2015","geo_state":"SC","gender":"M","race":null,"name":"Timothy Milliken","age":"56","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1085077098187093","news_link":"http://www.wltx.com/story/news/2015/07/27/sled-investigating-officer-involved-shooting/30758725/"},{"reported_date":"July 27, 2015","geo_state":"LA","gender":"M","race":"W","name":"Jean Paul Falgout","age":"45","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1084745448220258","news_link":"http://www.wwltv.com/story/news/local/lafourche-terrebonne/2015/07/27/officers-shoot-man-in-houma/30749627/"},{"reported_date":"July 26, 2015","geo_state":"SC","gender":"M","race":"W","name":"Zachary Hammond","age":"19","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1084522724909197","news_link":"http://wspa.com/2015/07/26/authorities-responding-to-deadly-officer-involved-shooting/\nFamily’s attorney says Seneca teen shot from behind: http://www.greenvilleonline.com/story/news/local/2015/07/29/zach-hammond-seneca-police/30852391/"},{"reported_date":"July 26, 2015","geo_state":"LA","gender":"M","race":"B","name":"Khari Westly","age":"33","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1084127311615405","news_link":"http://www.ksla.com/story/29634844/suspect-in-hostage-situation-dead-after-spd-officer-involved-shooting"},{"reported_date":"July 25, 2015","geo_state":"FL","gender":"M","race":"B","name":"Earl Jackson","age":"59","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1092296694131800","news_link":"http://www.miamiherald.com/news/local/crime/article28915918.html"},{"reported_date":"July 25, 2015","geo_state":"NV","gender":"M","race":"B","name":"Bryan Keith Day","age":"36","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083965021631634","news_link":"http://www.reviewjournal.com/news/las-vegas/metro-officer-wounded-suspect-shot-death"},{"reported_date":"July 25, 2015","geo_state":"GA","gender":"M","race":null,"name":"Roger Braswell","age":"50","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083684778326325","news_link":"http://www.wtoc.com/story/29631891/1-dead-after-officer-involved-shooting-in-decatur-co"},{"reported_date":"July 25, 2015","geo_state":"LA","gender":"M","race":null,"name":"Christopher Olmstead","age":"60","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083603765001093","news_link":"http://www.nola.com/crime/index.ssf/2015/07/breaking_new_orleans_police_sh.html#incart_river"},{"reported_date":"July 24, 2015","geo_state":"NC","gender":"M","race":null,"name":"Lee Aaron Gerston","age":"33","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083338398360963","news_link":"http://www.wfmynews2.com/story/news/crime/2015/07/24/standoff-armed-robbery-stokes-county/30651361/"},{"reported_date":"July 24, 2015","geo_state":"CA","gender":"M","race":"W","name":"Seth Raines","age":"44","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083315881696548","news_link":"http://www.latimes.com/local/lanow/la-me-ln-report-of-gunman-opening-fire-bring-lapd-swarm-in-studio-city-20150724-story.html"},{"reported_date":"July 23, 2015","geo_state":"FL","gender":"M","race":"W","name":"Robin George Welsh","age":"55","source_of_death":"V","kbp_link":"facebook.com/KilledByPolice/posts/1104038256290977","news_link":"http://www.wesh.com/news/bicyclist-struck-by-police-cruiser-has-died/34321568"},{"reported_date":"July 23, 2015","geo_state":"CA","gender":"F","race":null,"name":"Tamala Anne Satre","age":"44","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083595555001914","news_link":"http://www.sacbee.com/news/local/crime/article28452859.html"},{"reported_date":"July 23, 2015","geo_state":"SC","gender":"M","race":null,"name":"Brian Stortzum","age":"32","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1083104655051004","news_link":"http://www.carolinalive.com/news/story.aspx?id=1234584#.VbJhiVUViko"},{"reported_date":"July 23, 2015","geo_state":"MN","gender":"M","race":"W","name":"Derek R. Wolfsteller","age":"31","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082803798414423","news_link":"http://www.startribune.com/officer-involved-shooting-at-plymouth-arby-s-leaves-one-man-dead/318383701/"},{"reported_date":"July 23, 2015","geo_state":"WY","gender":"M","race":"W","name":"Robbie Lee Edison","age":"47","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082608085100661","news_link":"http://trib.com/news/local/crime-and-courts/man-dead-after-officer-involved-shooting-in-converse-county/article_21a539c9-1b63-5fdf-8d3c-52c45c3b8f26.html"},{"reported_date":"July 23, 2015","geo_state":"WI","gender":"M","race":"L","name":"Francisco Benitez-Santiago","age":"25","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082512815110188","news_link":"http://host.madison.com/news/local/crime_and_courts/update-homicide-suspect-dies-at-monroe-hospital-argument-may-have/article_6f5747d2-4d66-53c0-a603-b5e2c3c6c532.html"},{"reported_date":"July 23, 2015","geo_state":"OH","gender":"M","race":"B","name":"Dontae L. Martin","age":"34","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082482778446525","news_link":"http://www.whio.com/news/news/crime-law/harrison-twp-shooting-believed-to-involve-deputies/nm5KW/"},{"reported_date":"July 22, 2015","geo_state":"GA","gender":"M","race":"W","name":"Michael Todd Sabbie","age":"35","source_of_death":"C","kbp_link":"facebook.com/KilledByPolice/posts/1088797647815038","news_link":"http://www.wmcactionnews5.com/story/29700419/bi-state-jail-inmate-found-dead-laid-to-rest"},{"reported_date":"July 22, 2015","geo_state":"MI","gender":"M","race":"W","name":"James T. Bush","age":"20","source_of_death":"V","kbp_link":"facebook.com/KilledByPolice/posts/1085101568184646","news_link":"http://www.macombdaily.com/government-and-politics/20150722/update-fatal-motorcyclist-police-car-collision-under-investigation"},{"reported_date":"July 22, 2015","geo_state":"GA","gender":"M","race":null,"name":"Jerrod Tyre","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082471455114324","news_link":"http://www.wtoc.com/story/29602599/gbi-investigates-ois-death-in-wayne-county"},{"reported_date":"July 22, 2015","geo_state":"OK","gender":"M","race":"B","name":"Andre Dontrell Williams","age":"26","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082161531811983","news_link":"http://www.koco.com/news/okc-police-investigating-officerinvolved-shooting-on-northeast-side/34302646"},{"reported_date":"July 22, 2015","geo_state":"PA","gender":"M","race":"B","name":"Devon Guisherd","age":"26","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1081942361833900","news_link":"http://www.philly.com/philly/news/local/20150723_Cop_wounded_in_shooting_in_NE_Philly.html"},{"reported_date":"July 21, 2015","geo_state":"GA","gender":"M","race":"W","name":"Darren Billy Wilson","age":"47","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1081577755203694","news_link":"http://www.northwestgeorgianews.com/calhoun_times/news/police_fire/stick-wielding-man-fatally-shot-by-bartow-deputy/article_854c9ebe-2ff6-11e5-bafd-2fa36e142427.html"},{"reported_date":"July 21, 2015","geo_state":"FL","gender":"M","race":"W","name":"Joseph Fuller","age":"24","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1081534498541353","news_link":"http://www.local10.com/news/large-police-presence-outside-oakland-park-apartment-building/34278198"},{"reported_date":"July 21, 2015","geo_state":"OK","gender":"M","race":"W","name":"Stephen Ray Brown","age":"54","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1081280961900040","news_link":"http://www.koco.com/news/offduty-midwest-city-police-officer-involved-in-choctaw-shooting/34265766"},{"reported_date":"July 20, 2015","geo_state":"FL","gender":"M","race":null,"name":"Pierre Gabriel Koellner","age":"29","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1082642831763853","news_link":"http://www.al.com/news/mobile/index.ssf/2015/07/man_shot_during_altercation_wi.html"},{"reported_date":"July 20, 2015","geo_state":"TX","gender":"M","race":"W","name":"Joshua LeBoeuf","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1081025265258943","news_link":"http://www.12newsnow.com/story/29588216/chambers-county-deputy-involved-shooting-near-winnie"},{"reported_date":"July 20, 2015","geo_state":"IL","gender":"M","race":"L","name":"Heriberto Godinez Jr.","age":"24","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1080940538600749","news_link":"http://www.chicagotribune.com/news/local/breaking/ct-man-dies-in-police-custody-in-brighton-park-20150720-story.html"},{"reported_date":"July 20, 2015","geo_state":"CA","gender":"M","race":null,"name":"Jackie Brand Jr.","age":"50","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1080797861948350","news_link":"http://www.mohavedailynews.com/news/deputy-involved-in-fatal-shooting-in-needles/article_0d90f34a-2eb9-11e5-b493-7771378f788c.html"},{"reported_date":"July 20, 2015","geo_state":"TX","gender":"M","race":null,"source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1080792005282269","news_link":"http://abc13.com/news/one-dead-following-deputy-involved-shooting-at-nightclub/865562/"},{"reported_date":"July 19, 2015","geo_state":"OH","gender":"M","race":"B","name":"Samuel DuBose","age":"43","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1080594961968640","news_link":"http://www.cincinnati.com/story/news/2015/07/19/police-person-shot--mt-auburn/30391931/\nRaw video: http://www.cincinnati.com/videos/news/crime/crime-and-courts/2015/07/29/30840281/\nUC officer charged with murder for DuBose shooting: http://www.cincinnati.com/story/news/2015/07/29/publish/30830777/"},{"reported_date":"July 19, 2015","geo_state":"CA","gender":"M","race":"L","name":"Estevan Andrade Gomez","age":"26","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1080489678645835","news_link":"http://www.visaliatimesdelta.com/story/news/local/2015/07/19/man-custody-killed-farmersville-police-station/30385379/"},{"reported_date":"July 19, 2015","geo_state":"TX","gender":"M","race":"B","name":"Billy Ray Davis","age":"59","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1080352908659512","news_link":"http://www.click2houston.com/news/hpd-investigating-after-possible-incustody-death-in-southeast-houston/34238632"},{"reported_date":"July 18, 2015","geo_state":"MS","gender":"M","race":"W","name":"Troy Goode","age":"30","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1080942258600577","news_link":"http://wreg.com/2015/07/19/lawyer-man-was-hogtied-by-police-before-death/"},{"reported_date":"July 18, 2015","geo_state":"KS","gender":"M","race":"W","name":"Charles Dewey","age":"65","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1080810905280379","news_link":"http://www.kwch.com/news/local-news/kbi-investigating-officerinvolved-shooting-in-colby/34235912"},{"reported_date":"July 18, 2015","geo_state":"AZ","gender":"M","race":"W","name":"Kevin Thomas Snyder","age":"46","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079981678696635","news_link":"http://www.azcentral.com/story/news/local/phoenix/2015/07/18/west-phoenix-fatal-officer-involved-shooting-abrk/30349421/"},{"reported_date":"July 18, 2015","geo_state":"CO","gender":"M","race":"W","name":"David Wheat Jr.","age":"22","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079799802048156","news_link":"http://www.coloradoan.com/story/news/2015/07/18/officer-involved-shooting-fort-collins-csu/30341077/"},{"reported_date":"July 18, 2015","geo_state":"TN","gender":"M","race":"B","name":"Darrius Stewart","age":"19","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079795592048577","news_link":"http://www.commercialappeal.com/news/local-news/memphis-officer-fatally-shoots-wanted-suspect"},{"reported_date":"July 17, 2015","geo_state":"TX","gender":"M","race":"L","name":"Jose Roman Rodriguez","age":"24","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079241935437276","news_link":"http://www.brownsvilleherald.com/news/local/article_bb0a2d58-2c88-11e5-aac9-0b53da6d72ca.html\nRaw video: https://www.facebook.com/KilledByPolice/posts/1079241935437276?_rdr=p"},{"reported_date":"July 17, 2015","geo_state":"FL","gender":"M","race":"B","name":"Albert Joseph Davis","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079238382104298","news_link":"http://www.wesh.com/news/suspect-critically-injured-in-officerinvolved-shooting-at-wataunga-woods-apartments-police-say/34214332"},{"reported_date":"July 17, 2015","geo_state":"WA","gender":"M","race":"W","name":"Sam Toshiro Smith","age":"27","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079170218777781","news_link":"http://www.king5.com/story/news/crime/2015/07/17/ravenna-spd-cruiser-rammed/30286759/\nRaw video: https://www.youtube.com/watch?v=IzrNObfiv1I&feature=youtu.be"},{"reported_date":"July 16, 2015","geo_state":"WY","gender":"M","race":"L","name":"Saige Dell Hack","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1087441247950678","news_link":"http://www.kgwn.tv/home/headlines/UPDATE-One-Dead-after-Shooting-at-Police-316140371.html"},{"reported_date":"July 16, 2015","geo_state":"WV","gender":"M","race":"W","name":"William Dale Jeffries","age":"57","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1079326248762178","news_link":"http://www.wdtv.com/wdtv.cfm?func=view§ion=5-News&item=EXCLUSIVE-Weston-Man-Dead-Police-Officer-on-Administrative-Leave-24479"},{"reported_date":"July 16, 2015","geo_state":"WI","gender":"M","race":"L","name":"Antonio Gonzales","age":"29","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1079000505461419","news_link":"http://www.jsonline.com/news/shooting-reported-in-wauwatosa-b99539787z1-316069631.html"},{"reported_date":"July 16, 2015","geo_state":"FL","gender":"M","race":"B","name":"Edward Foster III","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078987352129401","news_link":"http://www.local10.com/news/suspect-wounded-in-homestead-policeinvolved-shooting/34204628"},{"reported_date":"July 16, 2015","geo_state":"TN","gender":"M","race":"O","name":"Mohammod Youssuf Abdulazeez","age":"24","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078800488814754","news_link":"http://wate.com/2015/07/16/officer-injured-in-active-shooter-incident-at-navy-recruiting-center-in-chattanooga/"},{"reported_date":"July 16, 2015","geo_state":"KS","gender":"M","race":"W","name":"Patrick Stephen Pippin","age":"30","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078744995486970","news_link":"http://www.kansascity.com/news/local/crime/article27392695.html"},{"reported_date":"July 16, 2015","geo_state":"CA","gender":"M","race":"W","name":"Jason Charles Davis","age":"41","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078734828821320","news_link":"http://www.smmirror.com/articles/News/Venice-Shooting-Man-Dies-Three-Days-After-Being-Shot-By-LAPD-Outside-Coffee-Shop/43770"},{"reported_date":"July 16, 2015","geo_state":"CA","gender":"M","race":null,"name":"Anthonie Smith","age":"25","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078706145490855","news_link":"http://www.pe.com/articles/officer-773456-perris-shooting.html"},{"reported_date":"July 15, 2015","geo_state":"MI","gender":"M","race":"W","name":"Eugene Kailing","age":"43","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1078242302203906","news_link":"http://www.wzzm13.com/story/news/local/2015/07/15/msp-trooper-fatally-shoots-erratic-person-in-osceola-co/30201151/"},{"reported_date":"July 14, 2015","geo_state":"OH","gender":"M","race":null,"name":"Charles Crandell","age":"70s","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077787615582708","news_link":"http://wkbn.com/2015/07/14/man-dies-in-shootout-with-police-in-southington/"},{"reported_date":"July 14, 2015","geo_state":"MA","gender":"M","race":"L","name":"Rafael Suazo","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077626258932177","news_link":"http://www.wcvb.com/news/man-shot-killed-by-police-during-alleged-drug-deal-identified/34155710"},{"reported_date":"July 14, 2015","geo_state":"FL","gender":"M","race":"B","name":"Chacarion Avant","age":"20","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077579555603514","news_link":"http://www.orlandosentinel.com/news/breaking-news/os-deputy-shooting-home-invasion-lake-20150714-story.html"},{"reported_date":"July 13, 2015","geo_state":"NC","gender":"M","race":null,"name":"Bruce Dean Stafford","age":"55","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1077749502253186","news_link":"http://www.wfmynews2.com/story/news/local/2015/07/14/man-dies-at-nc-jail-after-scuffle-with-officers/30132769/"},{"reported_date":"July 13, 2015","geo_state":"CA","gender":"M","race":"W","name":"Matthew Graham","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077325045628965","news_link":"http://www.cbsnews.com/news/report-missing-babys-father-killed-in-shootout-with-police/"},{"reported_date":"July 13, 2015","geo_state":"UT","gender":"M","race":"W","name":"Shane Gormley","age":"30","source_of_death":"T","kbp_link":"facebook.com/KilledByPolice/posts/1077319315629538","news_link":"http://www.kxlf.com/story/29538103/carjacking-suspect-dies-after-alleged-crime-spree-being-tased-multiple-times"},{"reported_date":"July 13, 2015","geo_state":"CA","gender":"M","race":null,"name":"Billy Maine","age":"31","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077305955630874","news_link":"http://www.appeal-democrat.com/news/yuba-county-deputies-shoot-and-kill-man/article_988dc48e-292b-11e5-aed0-fff834fef7bc.html"},{"reported_date":"July 13, 2015","geo_state":"WY","gender":"M","race":"W","name":"Christopher Charles Benton","age":"27","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077298825631587","news_link":"http://trib.com/news/local/crime-and-courts/casper-police-fatally-shoot-person-while-serving-search-warrant/article_3ed3c43d-ed77-5bb6-8ead-dda9382de124.html"},{"reported_date":"July 13, 2015","geo_state":"FL","gender":"M","race":"B","name":"Salvado Ellswood","age":"36","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077258205635649","news_link":"http://www.sun-sentinel.com/local/broward/fl-plantation-shooting-20150712-story.html"},{"reported_date":"July 13, 2015","geo_state":"GU","gender":"M/PI","race":"PI","name":"Elbert G. Piolo","age":"38","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1077221485639321","news_link":"http://www.guampdn.com/story/news/2015/07/13/guam-police-officer-arrested-suspicion-murder/30072425/"},{"reported_date":"July 13, 2015","geo_state":"OH","gender":"M","race":"W","name":"Nyal “Bud” Brown","age":"77","source_of_death":"V","kbp_link":"facebook.com/KilledByPolice/posts/1077082495653220","news_link":"http://www.dispatch.com/content/stories/local/2015/07/13/fatal-crash-on-hilltop.html"},{"reported_date":"July 13, 2015","geo_state":"CO","gender":"M","race":"I","name":"Paul Castaway","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1076953882332748","news_link":"http://www.denverpost.com/news/ci_28475571/denver-police-man-shot-several-times-by-officer?source=top_stories_bar\nRAW: Surveillance video of Paul Castaway shooting (graphic imagery): http://dptv.denverpost.com/2015/09/14/raw-surveillance-video-of-paul-castaway-shooting/"},{"reported_date":"July 12, 2015","geo_state":"IL","gender":"M","race":null,"name":"Matthew Watson","age":"24","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1076544509040352","news_link":"http://chicago.suntimes.com/crime/7/71/765120/police-involved-river-forest-shooting"},{"reported_date":"July 12, 2015","geo_state":"GA","gender":"M","race":"B","name":"Freddie Blue","age":"20","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1076542709040532","news_link":"http://www.ajc.com/news/news/crime-law/man-dies-after-being-shot-by-newton-deputies/nmxjG/"},{"reported_date":"July 12, 2015","geo_state":"TX","gender":"M","race":"W","name":"David Allen Lepine","age":"62","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1076352999059503","news_link":"http://www.statesman.com/news/news/crime-law/austin-police-shoot-kill-1-person-in-southwest-aus/nmxZy/"},{"reported_date":"July 12, 2015","geo_state":"GA","gender":"M","race":null,"name":"Frederick Farmer","age":"20","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1076294665732003","news_link":"http://www.wsbtv.com/news/news/local/gbi-investigates-fatal-officer-involved-shooting/nmxZz/"},{"reported_date":"July 11, 2015","geo_state":"AL","gender":"M","race":"B","name":"Anthony Dewayne Ware","age":"35","source_of_death":"C,R","kbp_link":"facebook.com/KilledByPolice/posts/1075887702439366","news_link":"http://www.al.com/news/tuscaloosa/index.ssf/2015/07/suspect_dies_after_tuscaloosa.html"},{"reported_date":"July 11, 2015","geo_state":"GA","gender":"M","race":"B","name":"George Mann","age":"35","source_of_death":"T,R","kbp_link":"facebook.com/KilledByPolice/posts/1075885229106280","news_link":"http://www.ajc.com/news/news/crime-law/man-dies-after-altercation-with-gwinnett-cops-gbi-/nmxKw/"},{"reported_date":"July 10, 2015","geo_state":"MO","gender":"M","race":null,"name":"Javon Hawkins","age":"21","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075517999143003","news_link":"http://www.kansascity.com/news/local/crime/article27006070.html"},{"reported_date":"July 10, 2015","geo_state":"CA","gender":"M","race":"W","name":"Neil Peter White","age":"38","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075335469161256","news_link":"http://www.latimes.com/local/lanow/la-me-ln-man-wounded-lapd-dies-20150710-story.html"},{"reported_date":"July 10, 2015","geo_state":"NV","gender":"M","race":"W","name":"James Michael Todora","age":"54","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075331729161630","news_link":"http://www.reviewjournal.com/news/las-vegas/metro-cop-wounded-man-dead-shooting-near-sahara-and-lindell"},{"reported_date":"July 10, 2015","geo_state":"CA","gender":"M","race":"W","name":"Cyrus Hurtado","age":"17","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075270562501080","news_link":"http://www.ksbw.com/news/man-fatally-shot-by-officers-in-boulder-creek/34095006"},{"reported_date":"July 10, 2015","geo_state":"UT","gender":"M","race":"W","name":"Rocco Joseph Palmisano III","age":"50","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075177665843703","news_link":"http://www.thespectrum.com/story/news/local/2015/07/10/officer-involved-shooting-parowan-sends-one-hospital/29950015/"},{"reported_date":"July 10, 2015","geo_state":"IL","gender":"M","race":null,"name":"Martice Milliner","age":"27","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1075173832510753","news_link":"http://chicago.suntimes.com/crime/7/71/759984/chicago-police-involved-grand-crossing-shooting"},{"reported_date":"July 9, 2015","geo_state":"TX","gender":"M","race":null,"name":"Jimmy Lloyd Washington","age":"53","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1074636445897825","news_link":"http://www.kwtx.com/home/headlines/Man-Who-Attacked-Texas-Police-Chief-Dies-In-Custody-312926931.html"},{"reported_date":"July 9, 2015","geo_state":"AZ","gender":"M","race":null,"name":"Robert Hammonds","age":"68","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1074609629233840","news_link":"http://www.azcentral.com/story/news/local/phoenix/2015/07/09/phoenix-police-shooting-cactus-abrk/29921801/"},{"reported_date":"July 9, 2015","geo_state":"NC","gender":"M","race":"W","name":"Dallas Shatley","age":"62","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1074340495927420","news_link":"http://www.wxii12.com/news/1-dead-in-deputy-involved-shooting-in-Ashe-County/34070958"},{"reported_date":"July 8, 2015","geo_state":"MS","gender":"M","race":"B","name":"Jonathan Sanders","age":"39","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1075316012496535","news_link":"http://www.wtok.com/home/headlines/New-Details-in-Stonewall-Death-Investigation-313047501.html"},{"reported_date":"July 8, 2015","geo_state":"OR","gender":"M","race":"W","name":"Michael T. Westrich","age":"59","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073868005974669","news_link":"http://www.katu.com/news/local/Officer-shot-in-Beaverton-Hidden-Village-mobile-home-park-police-return-fire-Denny-Road-closed-312513981.html"},{"reported_date":"July 8, 2015","geo_state":"KY","gender":"M","race":"W","name":"Joshua S. Blough","age":"28","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073747379320065","news_link":"http://www.wdrb.com/story/29493225/update-kentucky-state-police-say-man-shot-in-officer-involved-shooting-in-elizabethtown-has-died"},{"reported_date":"July 7, 2015","geo_state":"MO","gender":"M","race":"W","name":"Nicholas E. Booth","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073774872650649","news_link":"http://www.kansascity.com/news/local/crime/article26680258.html"},{"reported_date":"July 7, 2015","geo_state":"TX","gender":"M","race":"L","name":"Jose Graciano Lopez","age":"39","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073746535986816","news_link":"http://www.themonitor.com/news/local/authorities-armed-man-in-edinburg-standoff-killed-in-officer-involved/article_62b2b456-24f2-11e5-b79b-6b2f14f63dc2.html"},{"reported_date":"July 7, 2015","geo_state":"CA","gender":"M","race":"L","name":"Daniel Hernandez","age":"47","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073733799321423","news_link":"http://www.kerngoldenempire.com/story/d/story/officer-involved-shooting-at-stiern-park/21998/c8t07WsGB0yeiGigo_hN7g"},{"reported_date":"July 7, 2015","geo_state":"NJ","gender":"M","race":null,"source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073347972693339","news_link":"http://www.pressofatlanticcity.com/news/atlantic-city-stabbing-leaves-one-dead-police-shoot-kill-suspect/article_fa6bb7e2-24a8-11e5-b22a-93fc9282eb8a.html"},{"reported_date":"July 7, 2015","geo_state":"TX","gender":"M","race":"W","name":"Joe Cody","age":"59","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1073344349360368","news_link":"http://crimeblog.dallasnews.com/2015/07/dallas-police-involved-in-shooting-in-north-oak-cliff.html/"},{"reported_date":"July 7, 2015","geo_state":"NH","gender":"M","race":"W","name":"Hagen D. Esty-Lennon","age":"42","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072999426061527","news_link":"http://www.wmur.com/news/ag-man-42-killed-in-officerinvolved-shooting-in-bath/34031216"},{"reported_date":"July 7, 2015","geo_state":"TX","gender":"M","race":null,"source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072979912730145","news_link":"http://abc13.com/news/hpd-officer-opens-fire-one-suspect-killed-two-others-injured/832832/"},{"reported_date":"July 6, 2015","geo_state":"CA","gender":"M","race":"B","name":"Jason M. Hendley","age":"29","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072981836063286","news_link":"http://www.latimes.com/local/lanow/la-me-ln-lapd-sylmar-shooting-20150706-story.html"},{"reported_date":"July 6, 2015","geo_state":"AZ","gender":"M","race":"W","name":"Adam Edward Dujanovic","age":"33","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072578269436976","news_link":"http://www.azcentral.com/story/news/local/mesa/2015/07/06/mesa-police-shooting-vine-abrk/29786175/"},{"reported_date":"July 6, 2015","geo_state":"FL","gender":"M","race":"B","name":"Maximo Rabasa","age":"52","source_of_death":"T,R","kbp_link":"facebook.com/KilledByPolice/posts/1072568682771268","news_link":"http://www.miamiherald.com/news/local/community/miami-dade/little-havana/article26604022.html"},{"reported_date":"July 6, 2015","geo_state":"CA","gender":"M","race":"L","name":"David Oliva Sarabia","age":"27","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072566366104833","news_link":"http://www.mercedsunstar.com/news/article26604640.html"},{"reported_date":"July 6, 2015","geo_state":"CA","gender":"M","race":"W","name":"John Leonard Berry","age":"31","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072503086111161","news_link":"http://losangeles.cbslocal.com/2015/07/06/man-fatally-shot-by-deputy-in-lakewood/\nRaw video: http://www.latimes.com/local/california/la-me-sheriff-shooting-20150825-story.html"},{"reported_date":"July 6, 2015","geo_state":"OK","gender":"M","race":"L","name":"Tyler Rogers","age":"20","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072124499482353","news_link":"http://newsok.com/second-fatal-officer-involved-shooting-since-saturday-reported-in-south-oklahoma-city/article/5431953"},{"reported_date":"July 6, 2015","geo_state":"CA","gender":"M","race":"L","name":"Johnny Ray Anderson","age":"43","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1072122882815848","news_link":"http://ktla.com/2015/07/06/alleged-prowler-who-was-possibly-unarmed-is-fatally-shot-by-sheriffs-deputies-in-hawaiian-gardens/"},{"reported_date":"July 5, 2015","geo_state":"NJ","gender":"M","race":"W","name":"Neil Van De Putte","age":"25","source_of_death":"V","kbp_link":"facebook.com/KilledByPolice/posts/1071504629544340","news_link":"http://www.nj.com/ocean/index.ssf/2015/07/on-duty_lacey_police_officer_strikes_kills_man_cro.html"},{"reported_date":"July 5, 2015","geo_state":"CA","gender":"M","race":"W","name":"Johnathon Patrick Deming","age":"19","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1071442286217241","news_link":"http://www.nbcbayarea.com/news/local/Fatal-Officer-Involved-Shooting-in-Pleasanton-311680501.html"},{"reported_date":"July 5, 2015","geo_state":"TX","gender":"M","race":"W","name":"Richard Munroe","age":"25","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1071299132898223","news_link":"http://www.statesman.com/news/news/local/apd-officers-kill-two-overnight-including-man-who-/nmrsr/"},{"reported_date":"July 5, 2015","geo_state":"TX","gender":"M","race":"W","name":"Michael McGregor Holt","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1071298172898319","news_link":"http://www.statesman.com/news/news/local/apd-officers-kill-two-overnight-including-man-who-/nmrsr/"},{"reported_date":"July 4, 2015","geo_state":"TN","gender":"M","race":null,"name":"Michael Shannon Gaby","age":"37","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070913966270073","news_link":"http://www.local8now.com/news/headlines/Man-dies-in-officer-involved-shooting--311657141.html#.VZiQzqs7Lkg.facebook"},{"reported_date":"July 4, 2015","geo_state":"NV","gender":"M","race":null,"name":"Bryan David Bauer","age":"36","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070861842941952","news_link":"http://www.reviewjournal.com/news/nevada/man-dead-after-henderson-officer-involved-shooting"},{"reported_date":"July 4, 2015","geo_state":"OK","gender":"M","race":"B","name":"Robert Elando Manlone","age":"42","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070857572942379","news_link":"http://newsok.com/oklahoma-city-police-shoot-kill-man-saturday/article/5431785"},{"reported_date":"July 4, 2015","geo_state":"CA","gender":"M","race":"L","name":"Cesar A. Limon Juarez","age":"27","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070729236288546","news_link":"http://www.dailynews.com/general-news/20150704/west-covina-police-officer-fatally-shoots-knife-wielding-stabbing-suspect/1"},{"reported_date":"July 4, 2015","geo_state":"VA","gender":"M","race":"B","name":"Kawanza Jamaal Beaty","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070679392960197","news_link":"http://www.dailypress.com/news/newport-news/dp-officer-involved-shooting-in-newport-news-leaves-victim-dead-20150704-story.html"},{"reported_date":"July 4, 2015","geo_state":"NJ","gender":"M","race":"L","name":"Oscar Camacho","age":"33","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070668289627974","news_link":"http://www.courierpostonline.com/story/news/crime/2015/07/04/camden-police-officers-kill-man-gun/29693979/"},{"reported_date":"July 3, 2015","geo_state":"CA","gender":"M","race":"L","name":"Arturo Lopez","age":"46","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070639002964236","news_link":"http://www.nbclosangeles.com/news/local/Deputy-shooting-lancaster-311628441.html"},{"reported_date":"July 3, 2015","geo_state":"CA","gender":"M","race":"L","name":"Christian Siqueiros","age":"25","source_of_death":"R","kbp_link":"facebook.com/KilledByPolice/posts/1070283769666426","news_link":"http://www.dailybulletin.com/general-news/20150703/man-dies-while-in-montclair-police-custody"},{"reported_date":"July 3, 2015","geo_state":"CA","gender":"M","race":"A","name":"Ton Nguyen","age":"60","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1070033686358101","news_link":"http://www.cbs8.com/story/29469048/sdpd-shoots-man-armed-with-a-knife-in-north-county"},{"reported_date":"July 2, 2015","geo_state":"WV","gender":"M","race":null,"name":"Brian Johnson","age":"59","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069802736381196","news_link":"http://www.wvva.com/story/29466467/2015/07/02/breaking-news-1-dead-hostage-situation-leads-to-officer-involved-shooting"},{"reported_date":"July 2, 2015","geo_state":"FL","gender":"M","race":"B","name":"Victo Larosa III","age":"23","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069793383048798","news_link":"http://www.news4jax.com/news/suspect-killed-officer-injured-in-police-shooting/33974884"},{"reported_date":"July 2, 2015","geo_state":"FL","gender":"M","race":"W","name":"Julian Joseph","age":"40","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069785149716288","news_link":"http://www.miamiherald.com/news/local/community/miami-dade/miami-beach/article26060944.html"},{"reported_date":"July 2, 2015","geo_state":"OR","gender":"M","race":null,"name":"Kaleb Landon","age":"35","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069627413065395","news_link":"http://www.oregonlive.com/pacific-northwest-news/index.ssf/2015/07/oregon_state_police_shoot_and.html"},{"reported_date":"July 2, 2015","geo_state":"MA","gender":"M","race":"W","name":"Douglas Buckley","age":"45","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069537956407674","news_link":"http://www.wickedlocal.com/article/20150702/NEWS/150708999"},{"reported_date":"July 1, 2015","geo_state":"OR","gender":"M","race":"B","name":"Kevin Lamont Judson","age":"24","source_of_death":"G","kbp_link":"facebook.com/KilledByPolice/posts/1069132823114854","news_link":"http://newsregister.com/article?articleTitle=sheriff-s-deputy-shoots-kills-suspect-in-north-mcminnville--1435762123--18518--"}];

  // vm.test.map(function(killing) {
  //   vm.killingData = killing;
  //   Killing.create(vm.killingData);
  // });

  vm.submit = function() {
    Killing.create(vm.killingData)
      .success(function(data) {
        vm.processing = false;
        vm.message = data.message;
      });
  };
})

.controller('killingEditController', function(Killing, $routeParams, $location, datetime) {
  var vm = this;

  vm.type = 'edit';
  vm.processing = true;

  Killing.findById($routeParams.killing_id)
    .success(function(data) {
      console.log('date ', data.reported_date);
      var parser = datetime("MM-DD-YYYY");
      parser.setDate(data.reported_date);
      console.log('format ', parser.format);
      vm.processing = false;
      vm.killingData = data;
    });

  vm.submit = function() {
    vm.processing = true;
    Killing.update(vm.killingData._id, vm.killingData)
      .success(function(data) {
        vm.processing = false;
        vm.message = data.message;
        if (data.success) {
          $location.path('/killings');
        }
      });
  };
});
